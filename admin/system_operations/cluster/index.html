



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="LeoProject makes LeoFS, which is an open source distributed object storage system and a highly available, distributed, eventually consistent storage system. LeoFS is supporting the following features:Multi-protocol Support - S3-API, REST-API and NFS v3, Large Object Support, Multi Data Center Replication and others.">
      
      
      
        <meta name="author" content="LeoProject">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.1">
    
    
      
        <title>Cluster Operations - LeoFS Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.78aab2dc.css">
      
    
    
      <script src="../../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#cluster-operations" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../.." title="LeoFS Documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                LeoFS Documentation
              </span>
              <span class="md-header-nav__topic">
                Cluster Operations
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/leo-project/leofs/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    LeoFS Documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/leo-project/leofs/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../whats_new/" title="What's New?" class="md-nav__link">
      What's New?
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Getting Started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../installation/quick/" title="Quick Installation and Setup" class="md-nav__link">
      Quick Installation and Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../installation/cluster/" title="Building a LeoFS' cluster with Ansible" class="md-nav__link">
      Building a LeoFS' cluster with Ansible
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Concept and Architecture
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Concept and Architecture
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../architecture/README/" title="LeoFS' Architecture" class="md-nav__link">
      LeoFS' Architecture
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../architecture/leo_gateway/" title="LeoGateway's Architecture" class="md-nav__link">
      LeoGateway's Architecture
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../architecture/leo_storage/" title="LeoStorage's Architecture" class="md-nav__link">
      LeoStorage's Architecture
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../architecture/leo_manager/" title="LeoManager's Architecture" class="md-nav__link">
      LeoManager's Architecture
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      For Administrators
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        For Administrators
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-1" type="checkbox" id="nav-5-1">
    
    <label class="md-nav__link" for="nav-5-1">
      Setup
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-1">
        Setup
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../setup/planning_for_production/" title="Planning for Production" class="md-nav__link">
      Planning for Production
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../setup/supported_platforms/" title="Supported Platforms" class="md-nav__link">
      Supported Platforms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../setup/hardware_requirements/" title="Hardware Requirements" class="md-nav__link">
      Hardware Requirements
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../setup/network_config/" title="Network Configurations" class="md-nav__link">
      Network Configurations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../system_admin/load_balancing/" title="Load Balancing Configuration" class="md-nav__link">
      Load Balancing Configuration
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2" type="checkbox" id="nav-5-2">
    
    <label class="md-nav__link" for="nav-5-2">
      Settings
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-2">
        Settings
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../settings/cluster/" title="Cluster Settings" class="md-nav__link">
      Cluster Settings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../settings/environment_config/" title="Environment Configuration" class="md-nav__link">
      Environment Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../settings/leo_manager/" title="LeoManager Settings" class="md-nav__link">
      LeoManager Settings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../settings/leo_storage/" title="LeoStorage Settings" class="md-nav__link">
      LeoStorage Settings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../settings/leo_gateway/" title="LeoGateway Settings" class="md-nav__link">
      LeoGateway Settings
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-3" type="checkbox" id="nav-5-3">
    
    <label class="md-nav__link" for="nav-5-3">
      Interface
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-3">
        Interface
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../protocols/s3/" title="S3-API" class="md-nav__link">
      S3-API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../protocols/rest/" title="REST-API" class="md-nav__link">
      REST-API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../protocols/nfs_v3/" title="NFS v3" class="md-nav__link">
      NFS v3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-4" type="checkbox" id="nav-5-4" checked>
    
    <label class="md-nav__link" for="nav-5-4">
      System Operations
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-4">
        System Operations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../flow/" title="Operation Flow" class="md-nav__link">
      Operation Flow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../systemd/" title="Systemd Services" class="md-nav__link">
      Systemd Services
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../s3/" title="S3-API related Operations" class="md-nav__link">
      S3-API related Operations
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Cluster Operations
      </label>
    
    <a href="./" title="Cluster Operations" class="md-nav__link md-nav__link--active">
      Cluster Operations
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prior-knowledge" title="Prior Knowledge" class="md-nav__link">
    Prior Knowledge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operations" title="Operations" class="md-nav__link">
    Operations
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-a-node" title="Add a Node" class="md-nav__link">
    Add a Node
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-a-node" title="Remove a Node" class="md-nav__link">
    Remove a Node
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#take-over-a-node" title="Take Over a Node" class="md-nav__link">
    Take Over a Node
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#suspend-a-node" title="Suspend a Node" class="md-nav__link">
    Suspend a Node
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resume-a-node" title="Resume a Node" class="md-nav__link">
    Resume a Node
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#related-links" title="Related Links" class="md-nav__link">
    Related Links
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data/" title="Data Operations" class="md-nav__link">
      Data Operations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../multi_dc_replication/" title="Multi Data Center Replication" class="md-nav__link">
      Multi Data Center Replication
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-5" type="checkbox" id="nav-5-5">
    
    <label class="md-nav__link" for="nav-5-5">
      System Administration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-5">
        System Administration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../system_admin/log_management/" title="Log Management" class="md-nav__link">
      Log Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../system_admin/persistent_configuration/" title="Persistent Configuration" class="md-nav__link">
      Persistent Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../system_admin/monitoring/" title="System Monitoring" class="md-nav__link">
      System Monitoring
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../system_admin/migration/" title="System Migration" class="md-nav__link">
      System Migration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../system_admin/integration/" title="System Integration" class="md-nav__link">
      System Integration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../system_admin/multiple_nodes/" title="Multiple Node Instances" class="md-nav__link">
      Multiple Node Instances
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../index_of_commands/" title="Index of LeoFS' Commands" class="md-nav__link">
      Index of LeoFS' Commands
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../benchmark/README/" title="Benchmark" class="md-nav__link">
      Benchmark
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      FAQ
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        FAQ
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../faq/fundamentals/" title="LeoFS Fundamentals" class="md-nav__link">
      LeoFS Fundamentals
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../faq/limits/" title="LeoFS Limits" class="md-nav__link">
      LeoFS Limits
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../faq/administration/" title="LeoFS Administration" class="md-nav__link">
      LeoFS Administration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../faq/client/" title="LeoFS Clients" class="md-nav__link">
      LeoFS Clients
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../production_checklist/README/" title="Production Checklist" class="md-nav__link">
      Production Checklist
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      RFCS
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        RFCS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-1" type="checkbox" id="nav-9-1">
    
    <label class="md-nav__link" for="nav-9-1">
      Data Protection
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-9-1">
        Data Protection
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../RFCS/data_protection/ssec/" title="Server Side Object Encryption with Customer-Provided Encryption Keys" class="md-nav__link">
      Server Side Object Encryption with Customer-Provided Encryption Keys
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prior-knowledge" title="Prior Knowledge" class="md-nav__link">
    Prior Knowledge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operations" title="Operations" class="md-nav__link">
    Operations
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-a-node" title="Add a Node" class="md-nav__link">
    Add a Node
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-a-node" title="Remove a Node" class="md-nav__link">
    Remove a Node
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#take-over-a-node" title="Take Over a Node" class="md-nav__link">
    Take Over a Node
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#suspend-a-node" title="Suspend a Node" class="md-nav__link">
    Suspend a Node
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resume-a-node" title="Resume a Node" class="md-nav__link">
    Resume a Node
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#related-links" title="Related Links" class="md-nav__link">
    Related Links
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/leo-project/leofs/edit/master/docs/admin/system_operations/cluster.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="cluster-operations">Cluster Operations<a class="headerlink" href="#cluster-operations" title="Permanent link">&para;</a></h1>
<h2 id="prior-knowledge">Prior Knowledge<a class="headerlink" href="#prior-knowledge" title="Permanent link">&para;</a></h2>
<p>LeoFS provides the cluster operation features which are implemented on <a href="https://github.com/leo-project/leofs/blob/master/leofs-adm" target="_blank">leofs-adm</a>, LeoFS CLI for administration. LeoFS supports <code class="codehilite">node addition</code> and <code class="codehilite">node deletion</code>, and already covers as unique features of LeoFS, <code class="codehilite">node suspension</code>, <code class="codehilite">node restart</code>, and <code class="codehilite">node takeover</code>. You can use those functions after starting a LeoFS system.</p>
<h2 id="operations">Operations<a class="headerlink" href="#operations" title="Permanent link">&para;</a></h2>
<h3 id="add-a-node">Add a Node<a class="headerlink" href="#add-a-node" title="Permanent link">&para;</a></h3>
<p>LeoFS temporally adds a node into the member table of LeoManager's database after launching a new LeoStorage node. If you decide to join it in the cluster, you need to execute <a href="#rebalance-a-cluster">leofs-adm rebalance</a> command.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1">## Example:</span>
<span class="c1">## 1. Launch a new LeoStorage node</span>

<span class="c1">## 2. Check the current state of the cluster</span>
$ leofs-adm status
 <span class="o">[</span>System Confiuration<span class="o">]</span>
-----------------------------------+----------
 Item                              <span class="p">|</span> Value
-----------------------------------+----------
 Basic/Consistency level
-----------------------------------+----------
                    system version <span class="p">|</span> <span class="m">1</span>.3.3
                        cluster Id <span class="p">|</span> leofs_1
                             DC Id <span class="p">|</span> dc_1
                    Total replicas <span class="p">|</span> <span class="m">2</span>
          number of successes of R <span class="p">|</span> <span class="m">1</span>
          number of successes of W <span class="p">|</span> <span class="m">1</span>
          number of successes of D <span class="p">|</span> <span class="m">1</span>
 number of rack-awareness replicas <span class="p">|</span> <span class="m">0</span>
                         ring size <span class="p">|</span> <span class="m">2</span>^128
-----------------------------------+----------
 Multi DC replication settings
-----------------------------------+----------
        max number of joinable DCs <span class="p">|</span> <span class="m">2</span>
           number of replicas a DC <span class="p">|</span> <span class="m">1</span>
-----------------------------------+----------
 Manager RING <span class="nb">hash</span>
-----------------------------------+----------
                 current ring-hash <span class="p">|</span> d5d667a6
                previous ring-hash <span class="p">|</span> d5d667a6
-----------------------------------+----------

 <span class="o">[</span>State of Node<span class="o">(</span>s<span class="o">)]</span>
-------+--------------------------+--------------+----------------+----------------+----------------------------
 <span class="nb">type</span>  <span class="p">|</span>           node           <span class="p">|</span>    state     <span class="p">|</span>  current ring  <span class="p">|</span>   prev ring    <span class="p">|</span>          updated at
-------+--------------------------+--------------+----------------+----------------+----------------------------
  S    <span class="p">|</span> storage_0@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> d5d667a6       <span class="p">|</span> d5d667a6       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:20:19 +0900
  S    <span class="p">|</span> storage_1@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> d5d667a6       <span class="p">|</span> d5d667a6       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:20:19 +0900
  S    <span class="p">|</span> storage_2@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> d5d667a6       <span class="p">|</span> d5d667a6       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:20:19 +0900
  S    <span class="p">|</span> storage_3@127.0.0.1      <span class="p">|</span> attached     <span class="p">|</span>                <span class="p">|</span>                <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:20:37 +0900
  G    <span class="p">|</span> gateway_0@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> d5d667a6       <span class="p">|</span> d5d667a6       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:20:21 +0900
-------+--------------------------+--------------+----------------+----------------+----------------------------

<span class="c1">## 3. Execute `rebalance`</span>
$ leofs-adm rebalance
Generating rebalance-list...
Generated rebalance-list
Distributing rebalance-list to the storage nodes
OK  <span class="m">25</span>% - storage_0@127.0.0.1
OK  <span class="m">50</span>% - storage_1@127.0.0.1
OK  <span class="m">75</span>% - storage_2@127.0.0.1
OK <span class="m">100</span>% - storage_3@127.0.0.1
OK

<span class="c1">## 4. Check the latest state of cluster after rebalancing the cluster</span>
$ leofs-adm status
 <span class="o">[</span>System Confiuration<span class="o">]</span>
-----------------------------------+----------
 Item                              <span class="p">|</span> Value
-----------------------------------+----------
 Basic/Consistency level
-----------------------------------+----------
                    system version <span class="p">|</span> <span class="m">1</span>.3.3
                        cluster Id <span class="p">|</span> leofs_1
                             DC Id <span class="p">|</span> dc_1
                    Total replicas <span class="p">|</span> <span class="m">2</span>
          number of successes of R <span class="p">|</span> <span class="m">1</span>
          number of successes of W <span class="p">|</span> <span class="m">1</span>
          number of successes of D <span class="p">|</span> <span class="m">1</span>
 number of rack-awareness replicas <span class="p">|</span> <span class="m">0</span>
                         ring size <span class="p">|</span> <span class="m">2</span>^128
-----------------------------------+----------
 Multi DC replication settings
-----------------------------------+----------
        max number of joinable DCs <span class="p">|</span> <span class="m">2</span>
           number of replicas a DC <span class="p">|</span> <span class="m">1</span>
-----------------------------------+----------
 Manager RING <span class="nb">hash</span>
-----------------------------------+----------
                 current ring-hash <span class="p">|</span> ce4bece1
                previous ring-hash <span class="p">|</span> 3923d007
-----------------------------------+----------

 <span class="o">[</span>State of Node<span class="o">(</span>s<span class="o">)]</span>
-------+--------------------------+--------------+----------------+----------------+----------------------------
 <span class="nb">type</span>  <span class="p">|</span>           node           <span class="p">|</span>    state     <span class="p">|</span>  current ring  <span class="p">|</span>   prev ring    <span class="p">|</span>          updated at
-------+--------------------------+--------------+----------------+----------------+----------------------------
  S    <span class="p">|</span> storage_0@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> ce4bece1       <span class="p">|</span> 3923d007       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:20:19 +0900
  S    <span class="p">|</span> storage_1@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> ce4bece1       <span class="p">|</span> 3923d007       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:20:19 +0900
  S    <span class="p">|</span> storage_2@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> ce4bece1       <span class="p">|</span> 3923d007       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:20:19 +0900
  S    <span class="p">|</span> storage_3@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> ce4bece1       <span class="p">|</span> 3923d007       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:21:25 +0900
  G    <span class="p">|</span> gateway_0@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> ce4bece1       <span class="p">|</span> 3923d007       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:20:21 +0900
-------+--------------------------+--------------+----------------+----------------+----------------------------
</pre></div>
</td></tr></table>

<h3 id="remove-a-node">Remove a Node<a class="headerlink" href="#remove-a-node" title="Permanent link">&para;</a></h3>
<p>If you need to shrink a target LeoFS' cluster size, you can realize that by following the operation flow.</p>
<ul>
<li>Decide to remove a LeoStorage node, whose state must be <code class="codehilite">running</code> or <code class="codehilite">stop</code></li>
<li>Then execute <code class="codehilite">leofs-adm detach</code> command</li>
<li>Finally, execute <code class="codehilite">leofs-adm rebalance</code> command to start rebalancing data in the cluster</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1">## Example:</span>
<span class="c1">## 1. Check the current state of the cluster</span>
$ leofs-adm status
 <span class="o">[</span>System Confiuration<span class="o">]</span>
-----------------------------------+----------
 Item                              <span class="p">|</span> Value
-----------------------------------+----------
 Basic/Consistency level
-----------------------------------+----------
                    system version <span class="p">|</span> <span class="m">1</span>.3.3
                        cluster Id <span class="p">|</span> leofs_1
                             DC Id <span class="p">|</span> dc_1
                    Total replicas <span class="p">|</span> <span class="m">2</span>
          number of successes of R <span class="p">|</span> <span class="m">1</span>
          number of successes of W <span class="p">|</span> <span class="m">1</span>
          number of successes of D <span class="p">|</span> <span class="m">1</span>
 number of rack-awareness replicas <span class="p">|</span> <span class="m">0</span>
                         ring size <span class="p">|</span> <span class="m">2</span>^128
-----------------------------------+----------
 Multi DC replication settings
-----------------------------------+----------
        max number of joinable DCs <span class="p">|</span> <span class="m">2</span>
           number of replicas a DC <span class="p">|</span> <span class="m">1</span>
-----------------------------------+----------
 Manager RING <span class="nb">hash</span>
-----------------------------------+----------
                 current ring-hash <span class="p">|</span> 3923d007
                previous ring-hash <span class="p">|</span> 3923d007
-----------------------------------+----------

 <span class="o">[</span>State of Node<span class="o">(</span>s<span class="o">)]</span>
-------+--------------------------+--------------+----------------+----------------+----------------------------
 <span class="nb">type</span>  <span class="p">|</span>           node           <span class="p">|</span>    state     <span class="p">|</span>  current ring  <span class="p">|</span>   prev ring    <span class="p">|</span>          updated at
-------+--------------------------+--------------+----------------+----------------+----------------------------
  S    <span class="p">|</span> storage_0@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> 3923d007       <span class="p">|</span> 3923d007       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:31:37 +0900
  S    <span class="p">|</span> storage_1@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> 3923d007       <span class="p">|</span> 3923d007       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:31:37 +0900
  S    <span class="p">|</span> storage_2@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> 3923d007       <span class="p">|</span> 3923d007       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:31:37 +0900
  S    <span class="p">|</span> storage_3@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> 3923d007       <span class="p">|</span> 3923d007       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:31:37 +0900
  G    <span class="p">|</span> gateway_0@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> 3923d007       <span class="p">|</span> 3923d007       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:31:55 +0900
-------+--------------------------+--------------+----------------+----------------+----------------------------

<span class="c1">## 2. Remove a LeoStorage node</span>
$ leofs-adm detach storage_3@127.0.0.1
OK

<span class="c1">## 3. Execute `rebalance`</span>
$ leofs-adm rebalance
Generating rebalance-list...
Generated rebalance-list
Distributing rebalance-list to the storage nodes
OK  <span class="m">33</span>% - storage_0@127.0.0.1
OK  <span class="m">67</span>% - storage_1@127.0.0.1
OK <span class="m">100</span>% - storage_2@127.0.0.1
OK

<span class="c1">## 3. Check the latest state of cluster after rebalancing the cluster</span>
$ leofs-adm status
 <span class="o">[</span>System Confiuration<span class="o">]</span>
-----------------------------------+----------
 Item                              <span class="p">|</span> Value
-----------------------------------+----------
 Basic/Consistency level
-----------------------------------+----------
                    system version <span class="p">|</span> <span class="m">1</span>.3.3
                        cluster Id <span class="p">|</span> leofs_1
                             DC Id <span class="p">|</span> dc_1
                    Total replicas <span class="p">|</span> <span class="m">2</span>
          number of successes of R <span class="p">|</span> <span class="m">1</span>
          number of successes of W <span class="p">|</span> <span class="m">1</span>
          number of successes of D <span class="p">|</span> <span class="m">1</span>
 number of rack-awareness replicas <span class="p">|</span> <span class="m">0</span>
                         ring size <span class="p">|</span> <span class="m">2</span>^128
-----------------------------------+----------
 Multi DC replication settings
-----------------------------------+----------
        max number of joinable DCs <span class="p">|</span> <span class="m">2</span>
           number of replicas a DC <span class="p">|</span> <span class="m">1</span>
-----------------------------------+----------
 Manager RING <span class="nb">hash</span>
-----------------------------------+----------
                 current ring-hash <span class="p">|</span> d5d667a6
                previous ring-hash <span class="p">|</span> d5d667a6
-----------------------------------+----------

 <span class="o">[</span>State of Node<span class="o">(</span>s<span class="o">)]</span>
-------+--------------------------+--------------+----------------+----------------+----------------------------
 <span class="nb">type</span>  <span class="p">|</span>           node           <span class="p">|</span>    state     <span class="p">|</span>  current ring  <span class="p">|</span>   prev ring    <span class="p">|</span>          updated at
-------+--------------------------+--------------+----------------+----------------+----------------------------
  S    <span class="p">|</span> storage_0@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> d5d667a6       <span class="p">|</span> d5d667a6       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:31:37 +0900
  S    <span class="p">|</span> storage_1@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> d5d667a6       <span class="p">|</span> d5d667a6       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:31:37 +0900
  S    <span class="p">|</span> storage_2@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> d5d667a6       <span class="p">|</span> d5d667a6       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:31:37 +0900
  G    <span class="p">|</span> gateway_0@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> d5d667a6       <span class="p">|</span> d5d667a6       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:31:55 +0900
-------+--------------------------+--------------+----------------+----------------+----------------------------
</pre></div>
</td></tr></table>

<h3 id="take-over-a-node">Take Over a Node<a class="headerlink" href="#take-over-a-node" title="Permanent link">&para;</a></h3>
<p>If a new LeoStorage node takes over a detached node, you can realize that by following the operation flow.</p>
<ul>
<li>Execute <code class="codehilite">leofs-adm detach</code> command to remove a target node in the cluster</li>
<li>Then launch a new node to take over the detached node</li>
<li>Finally, execute <code class="codehilite">leofs-adm reebalance</code> command to start rebalancing data in the cluster</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1">## Example:</span>
<span class="c1">## 1. Check the current state of the cluster (1)</span>
$ leofs-adm status
 <span class="o">[</span>System Confiuration<span class="o">]</span>
-----------------------------------+----------
 Item                              <span class="p">|</span> Value
-----------------------------------+----------
 Basic/Consistency level
-----------------------------------+----------
                    system version <span class="p">|</span> <span class="m">1</span>.3.3
                        cluster Id <span class="p">|</span> leofs_1
                             DC Id <span class="p">|</span> dc_1
                    Total replicas <span class="p">|</span> <span class="m">2</span>
          number of successes of R <span class="p">|</span> <span class="m">1</span>
          number of successes of W <span class="p">|</span> <span class="m">1</span>
          number of successes of D <span class="p">|</span> <span class="m">1</span>
 number of rack-awareness replicas <span class="p">|</span> <span class="m">0</span>
                         ring size <span class="p">|</span> <span class="m">2</span>^128
-----------------------------------+----------
 Multi DC replication settings
-----------------------------------+----------
        max number of joinable DCs <span class="p">|</span> <span class="m">2</span>
           number of replicas a DC <span class="p">|</span> <span class="m">1</span>
-----------------------------------+----------
 Manager RING <span class="nb">hash</span>
-----------------------------------+----------
                 current ring-hash <span class="p">|</span> d5d667a6
                previous ring-hash <span class="p">|</span> d5d667a6
-----------------------------------+----------

 <span class="o">[</span>State of Node<span class="o">(</span>s<span class="o">)]</span>
-------+--------------------------+--------------+----------------+----------------+----------------------------
 <span class="nb">type</span>  <span class="p">|</span>           node           <span class="p">|</span>    state     <span class="p">|</span>  current ring  <span class="p">|</span>   prev ring    <span class="p">|</span>          updated at
-------+--------------------------+--------------+----------------+----------------+----------------------------
  S    <span class="p">|</span> storage_0@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> d5d667a6       <span class="p">|</span> d5d667a6       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:55:35 +0900
  S    <span class="p">|</span> storage_1@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> d5d667a6       <span class="p">|</span> d5d667a6       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:55:35 +0900
  S    <span class="p">|</span> storage_2@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> d5d667a6       <span class="p">|</span> d5d667a6       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:55:35 +0900
  G    <span class="p">|</span> gateway_0@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> d5d667a6       <span class="p">|</span> d5d667a6       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:55:37 +0900
-------+--------------------------+--------------+----------------+----------------+----------------------------

<span class="c1">## 2. Remove a LeoStorage node</span>
$ leofs-adm detach storage_0@127.0.0.1
OK

<span class="c1">## 3. Launch a new LeoStorage node</span>

<span class="c1">## 4. Check the current state of the cluster(2)</span>

$ leofs-adm status
 <span class="o">[</span>System Confiuration<span class="o">]</span>
-----------------------------------+----------
 Item                              <span class="p">|</span> Value
-----------------------------------+----------
 Basic/Consistency level
-----------------------------------+----------
                    system version <span class="p">|</span> <span class="m">1</span>.3.3
                        cluster Id <span class="p">|</span> leofs_1
                             DC Id <span class="p">|</span> dc_1
                    Total replicas <span class="p">|</span> <span class="m">2</span>
          number of successes of R <span class="p">|</span> <span class="m">1</span>
          number of successes of W <span class="p">|</span> <span class="m">1</span>
          number of successes of D <span class="p">|</span> <span class="m">1</span>
 number of rack-awareness replicas <span class="p">|</span> <span class="m">0</span>
                         ring size <span class="p">|</span> <span class="m">2</span>^128
-----------------------------------+----------
 Multi DC replication settings
-----------------------------------+----------
        max number of joinable DCs <span class="p">|</span> <span class="m">2</span>
           number of replicas a DC <span class="p">|</span> <span class="m">1</span>
-----------------------------------+----------
 Manager RING <span class="nb">hash</span>
-----------------------------------+----------
                 current ring-hash <span class="p">|</span> d5d667a6
                previous ring-hash <span class="p">|</span> d5d667a6
-----------------------------------+----------

 <span class="o">[</span>State of Node<span class="o">(</span>s<span class="o">)]</span>
-------+--------------------------+--------------+----------------+----------------+----------------------------
 <span class="nb">type</span>  <span class="p">|</span>           node           <span class="p">|</span>    state     <span class="p">|</span>  current ring  <span class="p">|</span>   prev ring    <span class="p">|</span>          updated at
-------+--------------------------+--------------+----------------+----------------+----------------------------
  S    <span class="p">|</span> storage_0@127.0.0.1      <span class="p">|</span> detached     <span class="p">|</span> d5d667a6       <span class="p">|</span> d5d667a6       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:56:32 +0900
  S    <span class="p">|</span> storage_1@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> d5d667a6       <span class="p">|</span> d5d667a6       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:55:35 +0900
  S    <span class="p">|</span> storage_2@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> d5d667a6       <span class="p">|</span> d5d667a6       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:55:35 +0900
  S    <span class="p">|</span> storage_3@127.0.0.1      <span class="p">|</span> attached     <span class="p">|</span>                <span class="p">|</span>                <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:56:47 +0900
  G    <span class="p">|</span> gateway_0@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> d5d667a6       <span class="p">|</span> d5d667a6       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:55:37 +0900
-------+--------------------------+--------------+----------------+----------------+----------------------------

<span class="c1">## 5. Execute `rebalance`</span>
$ leofs-adm rebalance
Generating rebalance-list...
Generated rebalance-list
Distributing rebalance-list to the storage nodes
OK  <span class="m">33</span>% - storage_2@127.0.0.1
OK  <span class="m">67</span>% - storage_3@127.0.0.1
OK <span class="m">100</span>% - storage_1@127.0.0.1
OK

<span class="c1">## 6. Check the latest state of the cluster</span>
$ leofs-adm status
 <span class="o">[</span>System Confiuration<span class="o">]</span>
-----------------------------------+----------
 Item                              <span class="p">|</span> Value
-----------------------------------+----------
 Basic/Consistency level
-----------------------------------+----------
                    system version <span class="p">|</span> <span class="m">1</span>.3.3
                        cluster Id <span class="p">|</span> leofs_1
                             DC Id <span class="p">|</span> dc_1
                    Total replicas <span class="p">|</span> <span class="m">2</span>
          number of successes of R <span class="p">|</span> <span class="m">1</span>
          number of successes of W <span class="p">|</span> <span class="m">1</span>
          number of successes of D <span class="p">|</span> <span class="m">1</span>
 number of rack-awareness replicas <span class="p">|</span> <span class="m">0</span>
                         ring size <span class="p">|</span> <span class="m">2</span>^128
-----------------------------------+----------
 Multi DC replication settings
-----------------------------------+----------
        max number of joinable DCs <span class="p">|</span> <span class="m">2</span>
           number of replicas a DC <span class="p">|</span> <span class="m">1</span>
-----------------------------------+----------
 Manager RING <span class="nb">hash</span>
-----------------------------------+----------
                 current ring-hash <span class="p">|</span> c613a468
                previous ring-hash <span class="p">|</span> c613a468
-----------------------------------+----------

 <span class="o">[</span>State of Node<span class="o">(</span>s<span class="o">)]</span>
-------+--------------------------+--------------+----------------+----------------+----------------------------
 <span class="nb">type</span>  <span class="p">|</span>           node           <span class="p">|</span>    state     <span class="p">|</span>  current ring  <span class="p">|</span>   prev ring    <span class="p">|</span>          updated at
-------+--------------------------+--------------+----------------+----------------+----------------------------
  S    <span class="p">|</span> storage_1@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> c613a468       <span class="p">|</span> c613a468       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:55:35 +0900
  S    <span class="p">|</span> storage_2@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> c613a468       <span class="p">|</span> c613a468       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:55:35 +0900
  S    <span class="p">|</span> storage_3@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> c613a468       <span class="p">|</span> c613a468       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:58:16 +0900
  G    <span class="p">|</span> gateway_0@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> c613a468       <span class="p">|</span> c613a468       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:55:37 +0900
-------+--------------------------+--------------+----------------+----------------+----------------------------
</pre></div>
</td></tr></table>

<h3 id="suspend-a-node">Suspend a Node<a class="headerlink" href="#suspend-a-node" title="Permanent link">&para;</a></h3>
<p>When maintenance of a node is necessary, you can suspend a target node temporally. A suspended node does not receive requests from LeoGateway nodes and LeoStorage nodes. LeoFS eventually distributes the state of the cluster to every node.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1">## Example:</span>
<span class="c1">## 1. Execute `suspend`</span>
$ leofs-adm <span class="nb">suspend</span> storage_1@127.0.0.1
OK


<span class="c1">## 2. Check the latest state of the cluster</span>
$ leofs-adm status
 <span class="o">[</span>System Confiuration<span class="o">]</span>
-----------------------------------+----------
 Item                              <span class="p">|</span> Value
-----------------------------------+----------
 Basic/Consistency level
-----------------------------------+----------
                    system version <span class="p">|</span> <span class="m">1</span>.3.3
                        cluster Id <span class="p">|</span> leofs_1
                             DC Id <span class="p">|</span> dc_1
                    Total replicas <span class="p">|</span> <span class="m">2</span>
          number of successes of R <span class="p">|</span> <span class="m">1</span>
          number of successes of W <span class="p">|</span> <span class="m">1</span>
          number of successes of D <span class="p">|</span> <span class="m">1</span>
 number of rack-awareness replicas <span class="p">|</span> <span class="m">0</span>
                         ring size <span class="p">|</span> <span class="m">2</span>^128
-----------------------------------+----------
 Multi DC replication settings
-----------------------------------+----------
        max number of joinable DCs <span class="p">|</span> <span class="m">2</span>
           number of replicas a DC <span class="p">|</span> <span class="m">1</span>
-----------------------------------+----------
 Manager RING <span class="nb">hash</span>
-----------------------------------+----------
                 current ring-hash <span class="p">|</span> c613a468
                previous ring-hash <span class="p">|</span> c613a468
-----------------------------------+----------

 <span class="o">[</span>State of Node<span class="o">(</span>s<span class="o">)]</span>
-------+--------------------------+--------------+----------------+----------------+----------------------------
 <span class="nb">type</span>  <span class="p">|</span>           node           <span class="p">|</span>    state     <span class="p">|</span>  current ring  <span class="p">|</span>   prev ring    <span class="p">|</span>          updated at
-------+--------------------------+--------------+----------------+----------------+----------------------------
  S    <span class="p">|</span> storage_1@127.0.0.1      <span class="p">|</span> <span class="nb">suspend</span>      <span class="p">|</span> c613a468       <span class="p">|</span> c613a468       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:55:35 +0900
  S    <span class="p">|</span> storage_2@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> c613a468       <span class="p">|</span> c613a468       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:55:35 +0900
  S    <span class="p">|</span> storage_3@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> c613a468       <span class="p">|</span> c613a468       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:58:16 +0900
  G    <span class="p">|</span> gateway_0@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> c613a468       <span class="p">|</span> c613a468       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:55:37 +0900
-------+--------------------------+--------------+----------------+----------------+----------------------------
</pre></div>
</td></tr></table>

<h3 id="resume-a-node">Resume a Node<a class="headerlink" href="#resume-a-node" title="Permanent link">&para;</a></h3>
<p>After suspending a node, if its node restarts and rejoins the cluster, execute <code class="codehilite">leofs-adm resume</code> command.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1">## Example:</span>
<span class="c1">## 1. Execute `resume`</span>
$ leofs-adm resume storage_1@127.0.0.1
OK

<span class="c1">## 2. Check the latest state of the cluster</span>
$ leofs-adm status
 <span class="o">[</span>System Confiuration<span class="o">]</span>
-----------------------------------+----------
 Item                              <span class="p">|</span> Value
-----------------------------------+----------
 Basic/Consistency level
-----------------------------------+----------
                    system version <span class="p">|</span> <span class="m">1</span>.3.3
                        cluster Id <span class="p">|</span> leofs_1
                             DC Id <span class="p">|</span> dc_1
                    Total replicas <span class="p">|</span> <span class="m">2</span>
          number of successes of R <span class="p">|</span> <span class="m">1</span>
          number of successes of W <span class="p">|</span> <span class="m">1</span>
          number of successes of D <span class="p">|</span> <span class="m">1</span>
 number of rack-awareness replicas <span class="p">|</span> <span class="m">0</span>
                         ring size <span class="p">|</span> <span class="m">2</span>^128
-----------------------------------+----------
 Multi DC replication settings
-----------------------------------+----------
        max number of joinable DCs <span class="p">|</span> <span class="m">2</span>
           number of replicas a DC <span class="p">|</span> <span class="m">1</span>
-----------------------------------+----------
 Manager RING <span class="nb">hash</span>
-----------------------------------+----------
                 current ring-hash <span class="p">|</span> c613a468
                previous ring-hash <span class="p">|</span> c613a468
-----------------------------------+----------

 <span class="o">[</span>State of Node<span class="o">(</span>s<span class="o">)]</span>
-------+--------------------------+--------------+----------------+----------------+----------------------------
 <span class="nb">type</span>  <span class="p">|</span>           node           <span class="p">|</span>    state     <span class="p">|</span>  current ring  <span class="p">|</span>   prev ring    <span class="p">|</span>          updated at
-------+--------------------------+--------------+----------------+----------------+----------------------------
  S    <span class="p">|</span> storage_1@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> c613a468       <span class="p">|</span> c613a468       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">19</span>:01:48 +0900
  S    <span class="p">|</span> storage_2@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> c613a468       <span class="p">|</span> c613a468       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:55:35 +0900
  S    <span class="p">|</span> storage_3@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> c613a468       <span class="p">|</span> c613a468       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:58:16 +0900
  G    <span class="p">|</span> gateway_0@127.0.0.1      <span class="p">|</span> running      <span class="p">|</span> c613a468       <span class="p">|</span> c613a468       <span class="p">|</span> <span class="m">2017</span>-04-18 <span class="m">18</span>:55:37 +0900
-------+--------------------------+--------------+----------------+----------------+----------------------------
</pre></div>
</td></tr></table>

<h2 id="related-links">Related Links<a class="headerlink" href="#related-links" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="../../settings/cluster/">For Administrators / Settings / Cluster Settings</a></li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../s3/" title="S3-API related Operations" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                S3-API related Operations
              </span>
            </div>
          </a>
        
        
          <a href="../data/" title="Data Operations" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Data Operations
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            (c) 2012-2018 LeoProject. All rights reserved.
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.8eb9be28.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:"../../.."}})</script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-5301881-3","leo-project.net"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>